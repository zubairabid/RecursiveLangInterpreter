<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-08-17 Mon 18:20 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Zubair Abid (20171076)" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org4c3785b">1. Introduction</a></li>
<li><a href="#org4c0f2c8">2. Recursion on Lists</a>
<ul>
<li><a href="#orgc91dfd0">2.1. Problem No. 1.1: Repeat</a>
<ul>
<li><a href="#orgbc4a1b5">2.1.1. Solution</a></li>
</ul>
</li>
<li><a href="#org8e13cf3">2.2. Problem No. 1.2: Invert</a>
<ul>
<li><a href="#org6c98cac">2.2.1. Solution:</a></li>
</ul>
</li>
<li><a href="#org55b3537">2.3. Problem No. 1.3: Count Occurences</a>
<ul>
<li><a href="#org0440f38">2.3.1. Solution</a></li>
</ul>
</li>
<li><a href="#orgbaeb1f4">2.4. Problem No. 1.4: Product</a>
<ul>
<li><a href="#org3fe914b">2.4.1. Solution</a></li>
</ul>
</li>
<li><a href="#orge233d6c">2.5. Problem No. 1.5: Every</a>
<ul>
<li><a href="#org28fff08">2.5.1. Solution</a></li>
</ul>
</li>
<li><a href="#org9cddcef">2.6. Problem No. 1.6: Merge</a>
<ul>
<li><a href="#org3db5dfd">2.6.1. Solution</a></li>
</ul>
</li>
<li><a href="#org83267c3">2.7. Flatten</a>
<ul>
<li><a href="#org1113de0">2.7.1. Solution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf87931a">3. Recursion on Trees</a>
<ul>
<li><a href="#orgc6fe7f1">3.1. Problem No. 2.1: Preorder Traversal</a>
<ul>
<li><a href="#orgc62ddd0">3.1.1. Solution</a></li>
</ul>
</li>
<li><a href="#org68a363a">3.2. Problem No. 2.2: Inorder</a>
<ul>
<li><a href="#org628b7b1">3.2.1. Solution</a></li>
</ul>
</li>
<li><a href="#orgbec0fd6">3.3. Problem No. 2.3: Postorder</a>
<ul>
<li><a href="#org2d3b0e4">3.3.1. Solution</a></li>
</ul>
</li>
<li><a href="#org3d32229">3.4. Problem No. 2.4: Count All Nodes</a>
<ul>
<li><a href="#org74bca1b">3.4.1. Solution</a></li>
</ul>
</li>
<li><a href="#orgf57b365">3.5. Problem No. 2.5: Count Leaf Nodes</a>
<ul>
<li><a href="#orgba50bcb">3.5.1. Solution</a></li>
</ul>
</li>
<li><a href="#org19131fc">3.6. Problem No. 2.6: Count Internal Nodes</a>
<ul>
<li><a href="#org6d631e5">3.6.1. Solution</a></li>
</ul>
</li>
<li><a href="#orgc39b6f2">3.7. Problem No. 2.7: Map</a>
<ul>
<li><a href="#org4061751">3.7.1. Solution:</a></li>
</ul>
</li>
<li><a href="#org921c538">3.8. Problem No. 2.8: Value at Path</a>
<ul>
<li><a href="#org6cea7fe">3.8.1. Solution</a></li>
</ul>
</li>
<li><a href="#org1a9e14f">3.9. Problem No. 2.9: Search</a></li>
<li><a href="#orgf7cf825">3.10. Problem No. 2.10: Update</a>
<ul>
<li><a href="#org9de3ec2">3.10.1. Solution</a></li>
</ul>
</li>
<li><a href="#orgbec0576">3.11. Problem No. 2.11: Insert</a>
<ul>
<li><a href="#org2ea54b1">3.11.1. Solution</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org3abdd37">4. Tangle</a></li>
</ul>
</div>
</div>

<div id="outline-container-org4c3785b" class="outline-2">
<h2 id="org4c3785b"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Solution to HW01 of PoPL Monsoon 2020.
</p>

<p>
All of the solutions have been implemented using recursion and avoid using 
any of the following inbuilt functions:
</p>

<ul class="org-ul">
<li><code>map</code></li>
<li><code>andmap</code></li>
<li><code>ormap</code></li>
<li><code>for-each</code></li>
<li><code>foldl</code></li>
</ul>
</div>
</div>

<div id="outline-container-org4c0f2c8" class="outline-2">
<h2 id="org4c0f2c8"><span class="section-number-2">2</span> Recursion on Lists</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgc91dfd0" class="outline-3">
<h3 id="orgc91dfd0"><span class="section-number-3">2.1</span> Problem No. 1.1: Repeat</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The function <code>(repeat n x)</code> has to return a list containing
<code>n</code> copies of <code>x</code>. 
</p>
</div>

<div id="outline-container-orgbc4a1b5" class="outline-4">
<h4 id="orgbc4a1b5"><span class="section-number-4">2.1.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
We define a recursive function <code>repeat</code>:
</p>

<dl class="org-dl">
<dt>Base case (<code>n == 0</code>)</dt><dd>Returns an empty list</dd>
<dt>Recursive step</dt><dd>Append the value <code>x</code> to the list returned by recursively
calling the function with <code>n-1</code> and <code>x</code></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="orgac16e3b"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">repeat</span> n x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>= n <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span>
      '<span style="color: #2d9574;">()</span>
      <span style="color: #2d9574;">(</span>cons x <span style="color: #67b11d;">(</span>repeat <span style="color: #b1951d;">(</span>- n <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> x<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8e13cf3" class="outline-3">
<h3 id="org8e13cf3"><span class="section-number-3">2.2</span> Problem No. 1.2: Invert</h3>
<div class="outline-text-3" id="text-2-2">
<p>
The function <code>(invert lst)</code> has to be implemented, where:
</p>
<dl class="org-dl">
<dt><code>lst</code></dt><dd>A list of (lists of length 2)</dd>
<dt><code>invert</code></dt><dd>A function to invert each <code>lst</code></dd>
</dl>
</div>

<div id="outline-container-org6c98cac" class="outline-4">
<h4 id="org6c98cac"><span class="section-number-4">2.2.1</span> Solution:</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
We define a recursive function <code>invert</code>:
</p>

<dl class="org-dl">
<dt>Base case (<code>lst</code> is empty)</dt><dd>Returns an empty list</dd>
<dt>Recursive step</dt><dd><ol class="org-ol">
<li>Take the <code>(car lst)</code> and <code>(reverse)</code> it.</li>
<li>Append (cons) the result of step 1 to the value returned by recursively
calling the function with <code>(cdr lst)</code></li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org577e5b1"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">invert</span> lst<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? lst<span style="color: #2d9574;">)</span>
      '<span style="color: #2d9574;">()</span>
      <span style="color: #2d9574;">(</span>cons <span style="color: #67b11d;">(</span>reverse <span style="color: #b1951d;">(</span>car lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>invert <span style="color: #b1951d;">(</span>cdr lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org55b3537" class="outline-3">
<h3 id="org55b3537"><span class="section-number-3">2.3</span> Problem No. 1.3: Count Occurences</h3>
<div class="outline-text-3" id="text-2-3">
<p>
The function <code>(count-occurences s slist)</code> has to be implemented,
where it returns the number of occurences of <code>s</code> in <code>slist</code>
</p>
</div>

<div id="outline-container-org0440f38" class="outline-4">
<h4 id="org0440f38"><span class="section-number-4">2.3.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
We implement the function <code>(count-occurrences)</code> recursively. But first, we
setup a local function <code>(occplus s comp)</code> which will check for equality
between <code>s</code> and <code>comp</code> and return 1 if true, and 0 if false.
</p>

<p>
Then the recusion is defined as:
</p>

<dl class="org-dl">
<dt>Base case (<code>slist</code> is empty)</dt><dd>return 0</dd>
<dt>Recursive step</dt><dd>Sum the following:
<ol class="org-ol">
<li>1 if the <code>(car slist)</code> is equal to the comparison s,
using occplus, 0 otherwise</li>
<li>The result of a recursive call with <code>s</code> and <code>(cdr
                           slist)</code></li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org1114240"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-occurrences</span> s slist<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #2d9574;">(</span><span style="color: #bc6ec5; font-weight: bold;">occplus</span> s comp<span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #67b11d;">(</span>= s comp<span style="color: #67b11d;">)</span>
        <span style="color: #a45bad;">1</span>
        <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? slist<span style="color: #2d9574;">)</span>
      <span style="color: #a45bad;">0</span>
      <span style="color: #2d9574;">(</span>+ <span style="color: #67b11d;">(</span>occplus s <span style="color: #b1951d;">(</span>car slist<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>count-occurrences s <span style="color: #b1951d;">(</span>cdr slist<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbaeb1f4" class="outline-3">
<h3 id="orgbaeb1f4"><span class="section-number-3">2.4</span> Problem No. 1.4: Product</h3>
<div class="outline-text-3" id="text-2-4">
<p>
We need to write a function <code>(product sos1 sos2)</code>, where:
</p>
<dl class="org-dl">
<dt><code>sos1</code>, <code>sos2</code></dt><dd>list of symbols without repetitions</dd>
<dt><code>product</code></dt><dd>function that will return the Cartesian product of the two
lists as a list of <code>2-lists</code></dd>
</dl>
</div>

<div id="outline-container-org3fe914b" class="outline-4">
<h4 id="org3fe914b"><span class="section-number-4">2.4.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
The idea is to recursively reduce <code>sos1</code> to a single-element list, and then
reduce <code>sos2</code> to a single element list, append the two, and then append that
to the returned value of the recursive call of <code>(cdr sos2)</code> and eventually
<code>(cdr sos1)</code>
</p>

<dl class="org-dl">
<dt>Base case(s)</dt><dd>There's two broad base cases:
<ul class="org-ul">
<li>If either <code>sos1</code> or <code>sos2</code> is empty, return the other.
This is as defined in the question. If neither list is
null to begin with, this case will not get triggered.</li>
<li>if both <code>sos1</code> and <code>sos2</code> are single-length, then return
a list appending the two</li>
</ul></dd>
<dt>Recursive step</dt><dd>Again, this is an if-else step:
<ul class="org-ul">
<li>If <code>sos1</code> is bigger than 1-element, append the result
of the recursive call with <code>(car sos1)</code> and the ones
with <code>(cdr sos1)</code></li>
<li>Likewise, but with <code>sos2</code></li>
</ul></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org880bade"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">product</span> sos1 sos2<span style="color: #bc6ec5;">)</span> 
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? sos1<span style="color: #67b11d;">)</span> sos2<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? sos2<span style="color: #67b11d;">)</span> sos1<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else 
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>&gt; <span style="color: #bc6ec5;">(</span>length sos1<span style="color: #bc6ec5;">)</span> <span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
         <span style="color: #4f97d7;">(</span>append <span style="color: #bc6ec5;">(</span>product <span style="color: #2d9574;">(</span>list <span style="color: #9cb6ad;">(</span>car sos1<span style="color: #9cb6ad;">)</span><span style="color: #2d9574;">)</span> sos2<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>product <span style="color: #2d9574;">(</span>cdr sos1<span style="color: #2d9574;">)</span> sos2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>&gt; <span style="color: #bc6ec5;">(</span>length sos2<span style="color: #bc6ec5;">)</span> <span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
         <span style="color: #4f97d7;">(</span>append <span style="color: #bc6ec5;">(</span>product sos1 <span style="color: #2d9574;">(</span>list <span style="color: #9cb6ad;">(</span>car sos2<span style="color: #9cb6ad;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>product sos1 <span style="color: #2d9574;">(</span>cdr sos2<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span>else <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>append sos1 sos2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orge233d6c" class="outline-3">
<h3 id="orge233d6c"><span class="section-number-3">2.5</span> Problem No. 1.5: Every</h3>
<div class="outline-text-3" id="text-2-5">
<p>
The function <code>(every pred lst)</code> needs to be implemented, where it takes a
list <code>lst</code> and does and <code>and</code> check against each element with the predicate
<code>pred</code>.
</p>
</div>

<div id="outline-container-org28fff08" class="outline-4">
<h4 id="org28fff08"><span class="section-number-4">2.5.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
We implement a recursive function, where 
</p>

<dl class="org-dl">
<dt>Base step (<code>lst</code> is empty)</dt><dd>returns true</dd>
<dt>Recursive step</dt><dd>return and <code>(and)</code> of the value of the <code>(pred)</code> on the
<code>(car lst)</code> and the value of the recursive call with <code>(cdr lst)</code></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org357470c"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">every</span> pred lst<span style="color: #bc6ec5;">)</span> 
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? lst<span style="color: #2d9574;">)</span>
      #t
      <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #67b11d;">(</span>pred <span style="color: #b1951d;">(</span>car lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>every pred <span style="color: #b1951d;">(</span>cdr lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org9cddcef" class="outline-3">
<h3 id="org9cddcef"><span class="section-number-3">2.6</span> Problem No. 1.6: Merge</h3>
<div class="outline-text-3" id="text-2-6">
<p>
The function <code>(merge loi1 loi2)</code> needs to take the two sorted lists <code>loi1</code>
and <code>loi2</code> and merge them such that the resulting list is also sorted.
</p>
</div>

<div id="outline-container-org3db5dfd" class="outline-4">
<h4 id="org3db5dfd"><span class="section-number-4">2.6.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
We define it recursively: if either list is empty, return the other,
otherwise compare the first elements of both and accordingly return the
appended element and the recursive call with the rest of the list and the
other list.
</p>

<dl class="org-dl">
<dt>Base cas (<code>loi1</code> or <code>loi2</code> is empty)</dt><dd>return the other list</dd>
<dt>Recursive step</dt><dd>Compare the <code>(car loi1)</code> with <code>(car loi2)</code>. The one
which is smaller will be appended to a new list along
with the result of the recursive function call with
<code>(cdr &lt;the list from which the smaller was taken&gt;)</code> and
<code>&lt;the other list&gt;</code></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="orgcaa80e9"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">merge</span> loi1 loi2<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> 
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? loi1<span style="color: #67b11d;">)</span> loi2<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? loi2<span style="color: #67b11d;">)</span> loi1<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else 
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #b1951d;">(</span>&lt; <span style="color: #4f97d7;">(</span>car loi1<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>car loi2<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
             <span style="color: #b1951d;">(</span>append <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>car loi1<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>merge <span style="color: #bc6ec5;">(</span>cdr loi1<span style="color: #bc6ec5;">)</span> loi2<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
             <span style="color: #b1951d;">(</span>append <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>car loi2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>merge loi1 <span style="color: #bc6ec5;">(</span>cdr loi2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org83267c3" class="outline-3">
<h3 id="org83267c3"><span class="section-number-3">2.7</span> Flatten</h3>
<div class="outline-text-3" id="text-2-7">
<p>
The function <code>(flatten dlst)</code> needs to be implemented, and flatten
out any nested structure in the <code>dlst</code>. <code>dlst</code> is a list of lists in some
nested heirarchial structure.
</p>
</div>

<div id="outline-container-org1113de0" class="outline-4">
<h4 id="org1113de0"><span class="section-number-4">2.7.1</span> Solution</h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
We make extensive use of the provided <code>(append list list)</code> function here.
After that, it's a rather straightforward recursive function.
</p>

<dl class="org-dl">
<dt>Base case(s)</dt><dd>There are two:
<ol class="org-ol">
<li>If <code>dlst</code> is empty, return an empty list</li>
<li>If <code>dlst</code> is not a list, return it as a list.</li>
</ol></dd>
<dt>Recursive step</dt><dd><code>(append)</code> the recursive calls with <code>(car dlst)</code> and
then <code>(cdr dlst)</code></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org5040bd4"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">flatten</span> dlst<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? dlst<span style="color: #67b11d;">)</span> '<span style="color: #67b11d;">()</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>not <span style="color: #b1951d;">(</span>list? dlst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list dlst<span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else <span style="color: #67b11d;">(</span>append <span style="color: #b1951d;">(</span>flatten <span style="color: #4f97d7;">(</span>car dlst<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>flatten <span style="color: #4f97d7;">(</span>cdr dlst<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf87931a" class="outline-2">
<h2 id="orgf87931a"><span class="section-number-2">3</span> Recursion on Trees</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgc6fe7f1" class="outline-3">
<h3 id="orgc6fe7f1"><span class="section-number-3">3.1</span> Problem No. 2.1: Preorder Traversal</h3>
<div class="outline-text-3" id="text-3-1">
<p>
The function <code>(traverse/preorder tree)</code> needs to do a preorder traversal of
the given <code>tree</code>, aka return a list with <code>leaf left right</code> traversing.
</p>
</div>

<div id="outline-container-orgc62ddd0" class="outline-4">
<h4 id="orgc62ddd0"><span class="section-number-4">3.1.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
We use recursion along with <code>(cases)</code> in order to navigate the
custom-defined datatype <code>full-binary-tree</code>.
</p>

<dl class="org-dl">
<dt>Base case (<code>tree</code> is a leaf-node)</dt><dd>Return the value of the node</dd>
<dt>Recursive case</dt><dd>If <code>tree</code> is an internal node, return an <code>(append)</code> with
the:
<ol class="org-ol">
<li>Value of the node</li>
<li>The result of a recursive call with the left subtree</li>
<li>The result of a recursive call with the right subtree</li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org6a518d3"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/preorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>list v<span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>traverse/preorder left<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>traverse/preorder right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org68a363a" class="outline-3">
<h3 id="org68a363a"><span class="section-number-3">3.2</span> Problem No. 2.2: Inorder</h3>
<div class="outline-text-3" id="text-3-2">
<p>
The function <code>(traverse/inorder tree)</code> needs to do a inorder traversal of
the given <code>tree</code>, aka return a list with <code>left leaf right</code> traversing.
</p>
</div>

<div id="outline-container-org628b7b1" class="outline-4">
<h4 id="org628b7b1"><span class="section-number-4">3.2.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
We use recursion along with <code>(cases)</code> in order to navigate the
custom-defined datatype <code>full-binary-tree</code>.
</p>

<dl class="org-dl">
<dt>Base case (<code>tree</code> is a leaf-node)</dt><dd>Return the value of the node</dd>
<dt>Recursive case</dt><dd>If <code>tree</code> is an internal node, return an <code>(append)</code> with
the:
<ol class="org-ol">
<li>The result of a recursive call with the left subtree</li>
<li>Value of the node</li>
<li>The result of a recursive call with the right subtree</li>
</ol></dd>
</dl>


<div class="org-src-container">
<pre class="src src-scheme" id="org6d78f28"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/inorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>traverse/inorder left<span style="color: #b1951d;">)</span> 
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>list v<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>traverse/inorder right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbec0fd6" class="outline-3">
<h3 id="orgbec0fd6"><span class="section-number-3">3.3</span> Problem No. 2.3: Postorder</h3>
<div class="outline-text-3" id="text-3-3">
<p>
The function <code>(traverse/psotorder tree)</code> needs to do a postorder traversal of
the given <code>tree</code>, aka return a list with <code>left right leaf</code> traversing.
</p>
</div>

<div id="outline-container-org2d3b0e4" class="outline-4">
<h4 id="org2d3b0e4"><span class="section-number-4">3.3.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
We use recursion along with <code>(cases)</code> in order to navigate the
custom-defined datatype <code>full-binary-tree</code>.
</p>

<dl class="org-dl">
<dt>Base case (<code>tree</code> is a leaf-node)</dt><dd>Return the value of the node</dd>
<dt>Recursive case</dt><dd>If <code>tree</code> is an internal node, return an <code>(append)</code> with
the:
<ol class="org-ol">
<li>The result of a recursive call with the left subtree</li>
<li>The result of a recursive call with the right subtree</li>
<li>Value of the node</li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org70a8a95"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/postorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>traverse/postorder left<span style="color: #b1951d;">)</span> 
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>traverse/postorder right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>list v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org3d32229" class="outline-3">
<h3 id="org3d32229"><span class="section-number-3">3.4</span> Problem No. 2.4: Count All Nodes</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Function <code>(count-nodes tree)</code> will count how many nodes are there.
</p>
</div>

<div id="outline-container-org74bca1b" class="outline-4">
<h4 id="org74bca1b"><span class="section-number-4">3.4.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
We use a recursive solution, to sum it up: for each node with a value, we
add 1 to the sum.
</p>

<dl class="org-dl">
<dt>Base case (tree is a leaf-node)</dt><dd>return 1</dd>
<dt>Recursive case (tree is an internal-node)</dt><dd>return the sum of 1 and the
recursive call with both
subtrees.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="orgc90767f"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-nodes</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #a45bad;">1</span> <span style="color: #b1951d;">(</span>count-nodes left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-nodes right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf57b365" class="outline-3">
<h3 id="orgf57b365"><span class="section-number-3">3.5</span> Problem No. 2.5: Count Leaf Nodes</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Function <code>(count-leaves tree)</code> will count how many leaf-nodes are there.
</p>
</div>

<div id="outline-container-orgba50bcb" class="outline-4">
<h4 id="orgba50bcb"><span class="section-number-4">3.5.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-5-1">
<p>
We use a recursive solution, to sum it up: for each node that is a
leaf-node, we add 1 to the sum.
</p>

<dl class="org-dl">
<dt>Base case (tree is a leaf-node)</dt><dd>return 1</dd>
<dt>Recursive case (tree is an internal-node)</dt><dd>return the sum of the
recursive call with both
subtrees.</dd>
</dl>


<div class="org-src-container">
<pre class="src src-scheme" id="org4418e59"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-leaves</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #b1951d;">(</span>count-leaves left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-leaves right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org19131fc" class="outline-3">
<h3 id="org19131fc"><span class="section-number-3">3.6</span> Problem No. 2.6: Count Internal Nodes</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Function <code>(count-internal tree)</code> will count how many internal-nodes are there
</p>
</div>

<div id="outline-container-org6d631e5" class="outline-4">
<h4 id="org6d631e5"><span class="section-number-4">3.6.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
We use a recursive solution, to sum it up: for each node that is an
internal-node, we add 1 to the sum.
</p>

<dl class="org-dl">
<dt>Base case (tree is a leaf-node)</dt><dd>return 0</dd>
<dt>Recursive case (tree is an internal-node)</dt><dd>return the sum of 1 and the
recursive call with both
subtrees.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org5af067d"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-internal</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #a45bad;">1</span> <span style="color: #b1951d;">(</span>count-internal left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-internal right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc39b6f2" class="outline-3">
<h3 id="orgc39b6f2"><span class="section-number-3">3.7</span> Problem No. 2.7: Map</h3>
<div class="outline-text-3" id="text-3-7">
<p>
The function <code>(tree/map fn tr)</code> needs to work like <code>(map)</code> but for trees.
</p>
</div>

<div id="outline-container-org4061751" class="outline-4">
<h4 id="org4061751"><span class="section-number-4">3.7.1</span> Solution:</h4>
<div class="outline-text-4" id="text-3-7-1">
<p>
We recursively navigate the tree such that:
</p>

<dl class="org-dl">
<dt>Base case (<code>tr</code> is a leaf-node)</dt><dd>return a new leaf-node with the
function <code>(fn)</code> applied to its value.</dd>
<dt>Recursive case (internal-node)</dt><dd>return a new internal-node with the 
<code>(fn)</code> applied to the value, and
recursive calls to the left and right
subtree as the left and right subtree
definitions.</dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org51978fc"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">tree/map</span> fn tr<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tr
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>lnode <span style="color: #b1951d;">(</span>fn v<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>inode <span style="color: #b1951d;">(</span>fn v<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>tree/map fn left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>tree/map fn right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org921c538" class="outline-3">
<h3 id="org921c538"><span class="section-number-3">3.8</span> Problem No. 2.8: Value at Path</h3>
<div class="outline-text-3" id="text-3-8">
<p>
Given a <code>path</code>, the function <code>(value-at-path path tree)</code> should navigate
through the <code>tree</code> and return the value of the node it reaches at the end of
the <code>path</code>.
</p>
</div>

<div id="outline-container-org6cea7fe" class="outline-4">
<h4 id="org6cea7fe"><span class="section-number-4">3.8.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
We navigate through the path as such: if the <code>path</code> is null, then we have 
found the solution. Here, we can return the value wrapped in a new node,
<code>(lnode v)</code> or <code>(inode v left right)</code> accordingly. Hoewever, if it is not,
then if the <code>(car)</code> is "left", we make a recursive call with the left 
subtree. However, if it's a leaf-node, we just return that as the search has
failed due to incorrect path. Likewise for if the <code>(car)</code> is "right" but
with the right subtree instead.
</p>

<dl class="org-dl">
<dt>Base case (<code>path</code> is empty)</dt><dd>Return the <code>tree</code>, which is the node at
the correct location</dd>
<dt>Recursive case</dt><dd>Depending on whether the <code>(car path)</code> is left or right,
<ol class="org-ol">
<li>If leaf node: this is a mistake, just return the node
as there's nothing else specified</li>
<li>If internal node: return the result of the recursive
call with the <code>(cdr path)</code> and the left/right
subtree.</li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org71fca84"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">path-item</span> <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">"left"</span> <span style="color: #2d9574;">"right"</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme" id="org5775009"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">value-at-path</span> path tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>cases full-binary-tree tree 
                    <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> v<span style="color: #b1951d;">)</span>
                    <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> v<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> tree<span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return the last node in the path</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>value-at-path <span style="color: #bc6ec5;">(</span>cdr path<span style="color: #bc6ec5;">)</span> left<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> tree<span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return the last node in the path</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>value-at-path <span style="color: #bc6ec5;">(</span>cdr path<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1a9e14f" class="outline-3">
<h3 id="org1a9e14f"><span class="section-number-3">3.9</span> Problem No. 2.9: Search</h3>
<div class="outline-text-3" id="text-3-9">
<div class="org-src-container">
<pre class="src src-scheme" id="orgeb662b8"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">search</span> val tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #b1951d;">(</span>= v val<span style="color: #b1951d;">)</span>
          '<span style="color: #b1951d;">()</span>
          #f<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> 
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>= v val<span style="color: #4f97d7;">)</span> '<span style="color: #4f97d7;">()</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>list? <span style="color: #bc6ec5;">(</span>search val left<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> 
            <span style="color: #4f97d7;">(</span>append 
              <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">very, and I cannot stress this</span>
              <span style="color: #bc6ec5;">(</span>search val left<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">enough, inefficient</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>list? <span style="color: #bc6ec5;">(</span>search val right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
            <span style="color: #4f97d7;">(</span>append 
              <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> 
              <span style="color: #bc6ec5;">(</span>search val right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span>else #f<span style="color: #b1951d;">]</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf7cf825" class="outline-3">
<h3 id="orgf7cf825"><span class="section-number-3">3.10</span> Problem No. 2.10: Update</h3>
<div class="outline-text-3" id="text-3-10">
<p>
The function <code>(update path fn tree)</code> will traverse through the tree using the
path like in problem 2.8, and instead of returning the node, will return the
node after applying <code>(fn)</code> to the value of the node.
</p>
</div>

<div id="outline-container-org9de3ec2" class="outline-4">
<h4 id="org9de3ec2"><span class="section-number-4">3.10.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-10-1">
<p>
Like the <code>(value-at-path)</code> function, it's a recursive function based on the
value of <code>path</code>.
</p>

<dl class="org-dl">
<dt>Base case (<code>path</code> is empty)</dt><dd>return:
<ol class="org-ol">
<li>an internal node with <code>(fn v)</code>, or</li>
<li>a leaf node with <code>(fn v)</code>, according to
what the original node (<code>tree</code>) was at
this point</li>
</ol></dd>
<dt>Recursive case</dt><dd>Return the <code>tree</code> (whatever node it is) with only the
following mofication:
<ol class="org-ol">
<li>If it is an internal node, then the branch taken
should be the result of the recursive call with the
aforesaid branch.</li>
<li>Else, return the node unchanged. The search has
failed due to faulty path.</li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org34a4707"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">update</span> path fn tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree 
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> 
          <span style="color: #4f97d7;">(</span>lnode <span style="color: #bc6ec5;">(</span>fn v<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> 
          <span style="color: #4f97d7;">(</span>inode <span style="color: #bc6ec5;">(</span>fn v<span style="color: #bc6ec5;">)</span> left right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v <span style="color: #bc6ec5;">(</span>update <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> fn left<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left <span style="color: #bc6ec5;">(</span>update <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> fn right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbec0576" class="outline-3">
<h3 id="orgbec0576"><span class="section-number-3">3.11</span> Problem No. 2.11: Insert</h3>
<div class="outline-text-3" id="text-3-11">
<p>
The function <code>(tree/insert path left-st right-st tree)</code> will traverse through 
the tree using the path like in problem 2.8 and 2.10, and will return the
tree (if the path points to a leaf node) with an internal node in place of
the earlier leaf node, with the <code>left-st</code> and <code>right-st</code> as subtrees.
</p>
</div>

<div id="outline-container-org2ea54b1" class="outline-4">
<h4 id="org2ea54b1"><span class="section-number-4">3.11.1</span> Solution</h4>
<div class="outline-text-4" id="text-3-11-1">
<p>
Like the <code>(update)</code> function, it's a recursive function based on the
value of <code>path</code>.
</p>

<dl class="org-dl">
<dt>Base case (<code>path</code> is empty)</dt><dd>return:
<ol class="org-ol">
<li>if it's a leaf-node, then return an
internal node with the same value and
the <code>left-st</code> and <code>right-st</code></li>
<li>else, return the node itself. There will
be no change to the tree as the path was
wrong.</li>
</ol></dd>
<dt>Recursive case</dt><dd>Return the <code>tree</code> (whatever node it is) with only the
following mofication:
<ol class="org-ol">
<li>If it is a leaf node, return the node unchanged. The
search has failed due to faulty path.</li>
<li>If it is an internal node, then the branch taken
should be the result of the recursive call with the
aforesaid branch.</li>
</ol></dd>
</dl>

<div class="org-src-container">
<pre class="src src-scheme" id="org96d62cf"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">tree/insert</span> path left-st right-st tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left-st right-st<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">faulty pathfinding</span>
          <span style="color: #4f97d7;">(</span>inode v left right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v <span style="color: #bc6ec5;">(</span>tree/insert <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> left-st right-st tree<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left <span style="color: #bc6ec5;">(</span>tree/insert <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> left-st right-st tree<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org3abdd37" class="outline-2">
<h2 id="org3abdd37"><span class="section-number-2">4</span> Tangle</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-scheme" id="orga4e171f">#lang racket/base
<span style="color: #4f97d7;">(</span>require eopl<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>require <span style="color: #2d9574;">"datatypes.rkt"</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">repeat</span> n x<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>= n <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span>
      '<span style="color: #2d9574;">()</span>
      <span style="color: #2d9574;">(</span>cons x <span style="color: #67b11d;">(</span>repeat <span style="color: #b1951d;">(</span>- n <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> x<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">invert</span> lst<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? lst<span style="color: #2d9574;">)</span>
      '<span style="color: #2d9574;">()</span>
      <span style="color: #2d9574;">(</span>cons <span style="color: #67b11d;">(</span>reverse <span style="color: #b1951d;">(</span>car lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>invert <span style="color: #b1951d;">(</span>cdr lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-occurrences</span> s slist<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #2d9574;">(</span><span style="color: #bc6ec5; font-weight: bold;">occplus</span> s comp<span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #67b11d;">(</span>= s comp<span style="color: #67b11d;">)</span>
        <span style="color: #a45bad;">1</span>
        <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? slist<span style="color: #2d9574;">)</span>
      <span style="color: #a45bad;">0</span>
      <span style="color: #2d9574;">(</span>+ <span style="color: #67b11d;">(</span>occplus s <span style="color: #b1951d;">(</span>car slist<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>count-occurrences s <span style="color: #b1951d;">(</span>cdr slist<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">product</span> sos1 sos2<span style="color: #bc6ec5;">)</span> 
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? sos1<span style="color: #67b11d;">)</span> sos2<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? sos2<span style="color: #67b11d;">)</span> sos1<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else 
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>&gt; <span style="color: #bc6ec5;">(</span>length sos1<span style="color: #bc6ec5;">)</span> <span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
         <span style="color: #4f97d7;">(</span>append <span style="color: #bc6ec5;">(</span>product <span style="color: #2d9574;">(</span>list <span style="color: #9cb6ad;">(</span>car sos1<span style="color: #9cb6ad;">)</span><span style="color: #2d9574;">)</span> sos2<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>product <span style="color: #2d9574;">(</span>cdr sos1<span style="color: #2d9574;">)</span> sos2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>&gt; <span style="color: #bc6ec5;">(</span>length sos2<span style="color: #bc6ec5;">)</span> <span style="color: #a45bad;">1</span><span style="color: #4f97d7;">)</span>
         <span style="color: #4f97d7;">(</span>append <span style="color: #bc6ec5;">(</span>product sos1 <span style="color: #2d9574;">(</span>list <span style="color: #9cb6ad;">(</span>car sos2<span style="color: #9cb6ad;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>product sos1 <span style="color: #2d9574;">(</span>cdr sos2<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span>else <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>append sos1 sos2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">every</span> pred lst<span style="color: #bc6ec5;">)</span> 
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #2d9574;">(</span>null? lst<span style="color: #2d9574;">)</span>
      #t
      <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">and</span> <span style="color: #67b11d;">(</span>pred <span style="color: #b1951d;">(</span>car lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>every pred <span style="color: #b1951d;">(</span>cdr lst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">merge</span> loi1 loi2<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> 
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? loi1<span style="color: #67b11d;">)</span> loi2<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? loi2<span style="color: #67b11d;">)</span> loi1<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else 
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #b1951d;">(</span>&lt; <span style="color: #4f97d7;">(</span>car loi1<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>car loi2<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
             <span style="color: #b1951d;">(</span>append <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>car loi1<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>merge <span style="color: #bc6ec5;">(</span>cdr loi1<span style="color: #bc6ec5;">)</span> loi2<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
             <span style="color: #b1951d;">(</span>append <span style="color: #4f97d7;">(</span>list <span style="color: #bc6ec5;">(</span>car loi2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>merge loi1 <span style="color: #bc6ec5;">(</span>cdr loi2<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">flatten</span> dlst<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? dlst<span style="color: #67b11d;">)</span> '<span style="color: #67b11d;">()</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>not <span style="color: #b1951d;">(</span>list? dlst<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list dlst<span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span>else <span style="color: #67b11d;">(</span>append <span style="color: #b1951d;">(</span>flatten <span style="color: #4f97d7;">(</span>car dlst<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>flatten <span style="color: #4f97d7;">(</span>cdr dlst<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/preorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>list v<span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>traverse/preorder left<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>traverse/preorder right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/inorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>traverse/inorder left<span style="color: #b1951d;">)</span> 
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>list v<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>traverse/inorder right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">traverse/postorder</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>list v<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>append 
        <span style="color: #b1951d;">(</span>traverse/postorder left<span style="color: #b1951d;">)</span> 
        <span style="color: #b1951d;">(</span>append 
          <span style="color: #4f97d7;">(</span>traverse/postorder right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>list v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-nodes</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #a45bad;">1</span> <span style="color: #b1951d;">(</span>count-nodes left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-nodes right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-leaves</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #b1951d;">(</span>count-leaves left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-leaves right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">count-internal</span> tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>+ <span style="color: #a45bad;">1</span> <span style="color: #b1951d;">(</span>count-internal left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>count-internal right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">tree/map</span> fn tr<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tr
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>lnode <span style="color: #b1951d;">(</span>fn v<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>inode <span style="color: #b1951d;">(</span>fn v<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>tree/map fn left<span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>tree/map fn right<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5; font-weight: bold;">path-item</span> <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">"left"</span> <span style="color: #2d9574;">"right"</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">value-at-path</span> path tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span> <span style="color: #67b11d;">(</span>cases full-binary-tree tree 
                    <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> v<span style="color: #b1951d;">)</span>
                    <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> v<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> tree<span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return the last node in the path</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>value-at-path <span style="color: #bc6ec5;">(</span>cdr path<span style="color: #bc6ec5;">)</span> left<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> tree<span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return the last node in the path</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>value-at-path <span style="color: #bc6ec5;">(</span>cdr path<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">search</span> val tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span>cases full-binary-tree tree
    <span style="color: #2d9574;">(</span>leaf-node <span style="color: #67b11d;">(</span>v<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">if</span> <span style="color: #b1951d;">(</span>= v val<span style="color: #b1951d;">)</span>
          '<span style="color: #b1951d;">()</span>
          #f<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #2d9574;">(</span>internal-node <span style="color: #67b11d;">(</span>v left right<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span> 
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>= v val<span style="color: #4f97d7;">)</span> '<span style="color: #4f97d7;">()</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>list? <span style="color: #bc6ec5;">(</span>search val left<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span> 
            <span style="color: #4f97d7;">(</span>append 
              <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">very, and I cannot stress this</span>
              <span style="color: #bc6ec5;">(</span>search val left<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">enough, inefficient</span>
        <span style="color: #b1951d;">[</span><span style="color: #4f97d7;">(</span>list? <span style="color: #bc6ec5;">(</span>search val right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
            <span style="color: #4f97d7;">(</span>append 
              <span style="color: #bc6ec5;">(</span>list <span style="color: #2d9574;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> 
              <span style="color: #bc6ec5;">(</span>search val right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">]</span>
        <span style="color: #b1951d;">[</span>else #f<span style="color: #b1951d;">]</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">update</span> path fn tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span> 
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree 
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> 
          <span style="color: #4f97d7;">(</span>lnode <span style="color: #bc6ec5;">(</span>fn v<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> 
          <span style="color: #4f97d7;">(</span>inode <span style="color: #bc6ec5;">(</span>fn v<span style="color: #bc6ec5;">)</span> left right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v <span style="color: #bc6ec5;">(</span>update <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> fn left<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left <span style="color: #bc6ec5;">(</span>update <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> fn right<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">define</span> <span style="color: #bc6ec5;">(</span><span style="color: #bc6ec5; font-weight: bold;">tree/insert</span> path left-st right-st tree<span style="color: #bc6ec5;">)</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">cond</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>null? path<span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left-st right-st<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">faulty pathfinding</span>
          <span style="color: #4f97d7;">(</span>inode v left right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">0</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v <span style="color: #bc6ec5;">(</span>tree/insert <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> left-st right-st tree<span style="color: #bc6ec5;">)</span> right<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">[</span><span style="color: #67b11d;">(</span>equal? <span style="color: #b1951d;">(</span>list-ref path-item <span style="color: #a45bad;">1</span><span style="color: #b1951d;">)</span> <span style="color: #b1951d;">(</span>car path<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span>
      <span style="color: #67b11d;">(</span>cases full-binary-tree tree
        <span style="color: #b1951d;">(</span>leaf-node <span style="color: #4f97d7;">(</span>v<span style="color: #4f97d7;">)</span> <span style="color: #4f97d7;">(</span>lnode v<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span> <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">return unchanged</span>
        <span style="color: #b1951d;">(</span>internal-node <span style="color: #4f97d7;">(</span>v left right<span style="color: #4f97d7;">)</span>
          <span style="color: #4f97d7;">(</span>inode v left <span style="color: #bc6ec5;">(</span>tree/insert <span style="color: #2d9574;">(</span>cdr path<span style="color: #2d9574;">)</span> left-st right-st tree<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span><span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;">;;; </span><span style="color: #2aa1ae; background-color: #292e34;">exporting only the required function</span>
<span style="color: #4f97d7;">(</span>provide repeat<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide invert<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide count-occurrences<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide product<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide every<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide merge<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide flatten<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide traverse/preorder<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide traverse/inorder<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide traverse/postorder<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide count-nodes<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide count-leaves<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide count-internal<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide tree/map<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide value-at-path<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide search<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide update<span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>provide tree/insert<span style="color: #4f97d7;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Zubair Abid (20171076)</p>
<p class="date">Created: 2020-08-17 Mon 18:20</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
